<!DOCTYPE html>

<html>
<head>
	<meta charset="UTF-8">
	<script Language='VBScript'>
	   Sub setBPM(value,skip)
	      Dim SDB : Set SDB = CreateObject("SongsDB.SDBApplication")
	      Dim curSong : Set curSong = SDB.Player.CurrentSong

	      curSong.BPM = value
	      curSong.UpdateDB
	      curSong.WriteTags

	      If skip Then
	           SDB.Player.Next()
	         SDB.Player.PlaybackTime = SDB.Player.CurrentSongLength*0.1
	      End If

	      Set curSong = Nothing
	      Set SDB = Nothing
	   End Sub
	</script>


	<script language=JavaScript>
	   <!-- Original:  Derek Chilcote-Batto (dac-b@usa.net) -->
	   <!-- Web Site:  http://www.mixed.net -->
	   <!-- Modified by:  Ronnie T. Moore, Editor -->
	   <!-- Later Modified into this version by Dale de Silva (www.oiltinman.net) for use in the programming MediaMonkey (www.mediamonkey.com)
	   <!-- Ronnie T script and many more are available free online at -->
	   <!-- The JavaScript Source!! http://javascript.internet.com -->

	   <!-- Netscape 4.x+ and MSIE 4.x+ compatible. -->


	   <!-- Begin
	   ns = (navigator.appName == 'Netscape');
	   ie = (navigator.appName == 'Microsoft Internet Explorer');

	   secs2 = 0;
	   count = 0;
	   allBpm = 0;
	   avgBpm = 0;
	   bpm = 0;

	   function resetAll() {
	      <!--reset all--!>
	      secs2 = 0;
	      count = 0;
	      allBpm = 0;
	      bpm = 0;

	      BPMtoSave = avgBpm
	      avgBpm = 0;

	      document.BEATSPERMINUTE.AVG.value = "";
	      document.BEATSPERMINUTE.HIT.value = "";
	      document.BEATSPERMINUTE.ACG.value = "";
	   }

	   function multB(e){
	      if(avgBpm>0){
	         avgBpm = avgBpm * e;
	         // document.BEATSPERMINUTE.AVG.value = avgBpm;
	         document.BEATSPERMINUTE.AVG.value = (Math.round(avgBpm * 100)) / 100;
	         }
	      return true;
	   }

	   function divB(e){
	      if(avgBpm>0){
	         avgBpm = avgBpm / e;
	         // document.BEATSPERMINUTE.AVG.value = avgBpm;
	         document.BEATSPERMINUTE.AVG.value = (Math.round(avgBpm * 100)) / 100;
	         }
	      return true;
	   }

	   function saveBPM(){
	      if(avgBpm>0){
	         resetAll();
	         document.BEATSPERMINUTE.AVG.value = "Saved";
	         document.BEATSPERMINUTE.HIT.value = "";
	         document.BEATSPERMINUTE.ACG.value = "";
	         //VBscript call MUST go at end or the other actions wont complete
	         if(document.BEATSPERMINUTE.SKIP.checked == true){
	            setBPM(BPMtoSave,true);
	         } else {
	            setBPM(BPMtoSave,false);
	         }
	      } else {

	      }
	   }

	   function bpmCounter(e) {

	      //if (ns) clearBpm = e.which;
	      //else if (ie) clearBpm = event.button;

	      timeSeconds = new Date;
	      secs = timeSeconds.getTime();

	      if (count == 0) {
	         document.BEATSPERMINUTE.AVG.value = "Begin When Ready";
	         document.BEATSPERMINUTE.HIT.value = "";
	         document.BEATSPERMINUTE.ACG.value = "";
	         count = "start"
	      } else if (count == "start"){
	         document.BEATSPERMINUTE.AVG.value = "1st Click";
	         document.BEATSPERMINUTE.HIT.value = "";
	         document.BEATSPERMINUTE.ACG.value = "";
	         count = 1
	         secs2 = secs;
	      } else {
	         oldBpm = bpm;
	         bpm = (1 / ((secs - secs2) / 1000)) * 60;
	         bpmChg = (Math.round((bpm - oldBpm) * 10)) / 10;
	         count++;
	         allBpm = allBpm + bpm;
	         oldAvg = avgBpm;
	         avgBpm = allBpm / (count - 1);
	         avgChg = (Math.round((avgBpm - oldAvg) * 10)) / 10;
	         secs2 = secs;
	         if (bpmChg >= 0) {
	            PbpmChg = "+" + bpmChg
	         } else {
	            PbpmChg = bpmChg
	         }
	         if (avgChg >= 0) {
	            PavgChg = "+" + avgChg
	         } else {
	            PavgChg = avgChg
	         }
	         document.BEATSPERMINUTE.AVG.value = (Math.round(avgBpm * 100)) / 100;
	         document.BEATSPERMINUTE.ACG.value = PavgChg;
	         document.BEATSPERMINUTE.HIT.value = count;
	      }
	      return true;
	   }
	   //document.onkeydown = bpmCounter;
	   //document.onmousedown = bpmCounter;
	   //  End -->

	</script>

	<style type="text/css">

		h1 {
			font-size: 11px;
			font-family:Verdana, Arial, Helvetica, sans-serif;
			text-align: center;
			color: #999999;
		}

		h2 {
			font-size: 10px;
			font-family:Verdana, Arial, Helvetica, sans-serif;
			text-align: center;
			color: #999999;
		}

		h3 {
			font-size: 9px;
			font-family:Verdana, Arial, Helvetica, sans-serif;
			text-align: center;
			color: #BBBBBB;
		}

		feedback {
			font-size: 15px;
			font-family:Verdana, Arial, Helvetica, sans-serif;
			color: #000000;
			text-align: right;
		}

		html, body {
			height: 100%;
		}

		body {
			margin:0;
			font-family: arial, helvetica, sans-serif;
			cursor: crosshair;
		}

		#bpm-container {
			position: relative;
			width: 100%;
			height: 100%;
			text-align: center;
		}

		.bpm-instruction {
			xposition: relative;
			xtop: 50%;
			xleft: 0%;
			font-size: 10em;
			margin: 0;
		}

		.noborders {
			border: 0;
		}

		.hidden {
			display: none;
		}

		.bpm-clear {
			border: 1px solid #00f;
			border-radius: 50%;
			padding:.5em;
		}

		.bpm-clear:hover {
			cursor: pointer;
		}
	</style>
</head>
<body>
	<div id="bpm-container" onMouseDown="bpmCounter(null)" onKeyPress="bpmCounter(null)">
		<p class="bpm-instruction">
			Click
		</p>
		<p class="bpm-data">
			<form name="BEATSPERMINUTE">
				BPM: <input size="14" name="AVG" readonly="readonly">
				&nbsp;
				<span name="bpm-reset" onClick="resetAll()" class="bpm-clear">X</span>
				<br>
				<input name="mult2" type=button value=" &#8226; 2" onClick="multB(2)" class="hidden">
				<input name="div2" type=button value=" &divide; 2" onClick="divB(2)" class="hidden">
				<br/>
				<input name="mult3" type=button value=" &#8226; 3" onClick="multB(3)" class="hidden">
				<input name="div3" type=button value=" &divide; 3" onClick="divB(3)" class="hidden">
				#<input size="2" name="HIT" readonly class="noborders">:
				<input size="2" name="ACG" readonly class="noborders">
			</form>
		</p>


<!--
<FORM name=BEATSPERMINUTE style="display: none;">
   <table width="100%" height="100%" border="0">
      <tr>
        <td>
        <h2>
        <input name="tap" type=button value="        TAP        " onMouseDown="bpmCounter(null)" onKeyPress="bpmCounter(null)">
        <BR/>
        <input name="Button" type=button value=" Clear " onClick="resetAll()">
        <input name="save" type=button value=" Save " onClick="saveBPM()">
        <BR/>
        <INPUT size=14 name=AVG>
        <br>
        <input name="mult2" type=button value=" &#8226; 2" onClick="multB(2)">
          <input name="div2" type=button value=" &divide; 2" onClick="divB(2)">
          <br/>
          <input name="mult3" type=button value=" &#8226; 3" onClick="multB(3)">
          <input name="div3" type=button value=" &divide; 3" onClick="divB(3)">
          <BR/>
        Diff.<input size=2 name=ACG>No.<INPUT size=2 name=HIT>
        <BR/>
        Skip Song On Save
        <input name=SKIP type="checkbox" value="skip">
        </h2>
       <h3>If clicking "TAP" with your mouse doesn't seem to be registering every hit.. use your spacebar        </h3>      </td>
      </tr>
    </table>
</FORM>
// -->
	</div>
</body>
</html>